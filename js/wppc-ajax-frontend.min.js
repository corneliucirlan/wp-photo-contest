jQuery(document).ready(function(e){e("#contest-photo-gallery").on("change",".wppc-select-filter",function(t){t.preventDefault();var n=e(this).val();e(".wppc-select-filter").prop("selectedIndex",0);e(this).val(n);e("#wppc-button-filter").val("mobile-only").text("Mobile only");var r={action:"wppc-filter-photos","wppc-id":e(this).prev().val(),"wppc-filter":e(this).val(),"wppc-url":document.URL};e.ajax({url:wppcSubmitPhoto.ajaxurl,type:"POST",data:r,dataType:"html",beforeSend:function(t,n){e("#wppc-photos").html('<div style="text-align: center;"><img src="http://www.uncover-romania.com/wp-content/plugins/wp-photo-contest/img/ajax-loading.gif" style="width: 20px !important;"></div>')},success:function(t,n,r){console.log(t);e("#wppc-photos").html(t);e(".group1").colorbox({rel:"group1",transition:"fade",maxWidth:"70%"});e("#wppc-contest-pages").tabs();window.parsePinBtns()},error:function(e,t,n){console.log(e)}})});e("#contest-photo-gallery").on("click","#wppc-button-filter",function(t){t.preventDefault();e(".wppc-select-filter").prop("selectedIndex",0);var n={action:"wppc-filter-photos","wppc-id":e(this).prev().val(),"wppc-filter":e(this).val(),"wppc-url":document.URL};e.ajax({url:wppcSubmitPhoto.ajaxurl,type:"POST",data:n,dataType:"html",beforeSend:function(t,n){e("#wppc-photos").html('<div style="text-align: center;"><img src="http://www.uncover-romania.com/wp-content/plugins/wp-photo-contest/img/ajax-loading.gif" style="width: 20px !important;"></div>');if(e("#wppc-button-filter").val()==="mobile-only")e("#wppc-button-filter").val("mobile-all").text("All photos");else e("#wppc-button-filter").val("mobile-only").text("Mobile only")},success:function(t,n,r){console.log(t);e("#wppc-photos").html(t);e(".group1").colorbox({rel:"group1",transition:"fade",maxWidth:"70%"});e("#wppc-contest-pages").tabs();window.parsePinBtns()},error:function(e,t,n){console.log(e)}})});e("#contest-photo-gallery").on("submit","form.wppc-vote-photo",function(t){t.preventDefault();e.ajax({url:wppcSubmitPhoto.ajaxurl,type:"POST",data:e(this).serialize(),dataType:"json",beforeSend:function(t,n){e(".wppc-vote-photo").addClass("disabled")},success:function(t,n,r){var i="#vote-results-"+t["wppc-value"];var s=e(i);console.log(t);switch(t.voteAdded){case true:s.hide().removeClass("alert-warning alert-info alert-success");s.show().addClass("alert-success").html("<p>Vote added</p>");s.prev("p").html(t.photoPoints+" points with "+t.photoVotes+" votes so far");break;case false:s.hide().removeClass("alert-warning alert-info alert-success");s.show().addClass("alert-info").html("<p>You can't vote anymore</p>");break;case"24H":s.hide().removeClass("alert-warning alert-info alert-success");s.show().addClass("alert-warning").html("<p>Already voted in the last 24h</p>");break}e(".wppc-vote-photo").removeClass("disabled")},error:function(e,t,n){console.log(e)}})});e("#contest-entry-form").on("submit","#wppc-form",function(t){function s(t){o(e("#wppc-name"),t.name);o(e("#wppc-email"),t.email);o(e("#wppc-photo"),t.photo);o(e("#wppc-mobile-photo"),t.mobilePhoto);o(e("#wppc-photo-name"),t.photoName);o(e("#wppc-photo-location"),t.photoLocation);o(e("#wppc-agree-rules"),t.agreeRules)}function o(t,i){if(i==""){t.parent().removeClass("has-error has-success");t.next().remove();t.parent().addClass("has-error");t.after(r)}else{t.parent().removeClass("has-error has-success");t.next().remove();t.parent().addClass("has-success");t.after(n)}if(t==e("#wppc-photo")&&i==""){t.parent().removeClass("has-error has-success");t.next().remove();t.parent().addClass("has-error");t.after(r)}}t.preventDefault();var n='<span class="glyphicon glyphicon-ok form-control-feedback"></span>';var r='<span class="glyphicon glyphicon-remove form-control-feedback"></span>';var i=new FormData;e.each(e("#wppc-photo")[0].files,function(e,t){i.append("file-"+e,t)});i.append("action",wppcSubmitPhoto.action);i.append("wppc-id",e("#wppc-id").val());i.append("wppc-name",e("#wppc-name").val());i.append("wppc-email",e("#wppc-email").val());i.append("wppc-mobile-photo",e("#wppc-mobile-photo").is(":checked"));i.append("wppc-photo-name",e("#wppc-photo-name").val());i.append("wppc-photo-location",e("#wppc-photo-location").val());i.append("wppc-agree-rules",e("#wppc-agree-rules").is(":checked"));e.ajax({url:wppcSubmitPhoto.ajaxurl,type:"POST",data:i,mimeType:"multipart/form-data",contentType:false,dataType:"json",cache:false,processData:false,beforeSend:function(t,n){e("#wppc-submit").addClass("disabled");e("#wppc-loading").show()},success:function(t,n,r){console.log(t);switch(t.entryAdded){case true:var i="<div class='alert alert-success' style='text-align: center;' role='alert'>";i+="Upload successful.";i+="</div>";e("#wppc-results").html(i).show();e(".glyphicon").remove();e("div").removeClass("has-error has-success");e("#wppc-photo, #wppc-photo-name, #wppc-photo-location").val("");break;case"TOTAL":var i="<div class='alert alert-warning' style='text-align: center;' role='alert'>";i+="You already uploaded the allowed number of photos.";i+="</div>";e("#wppc-results").html(i).show();e(".glyphicon").remove();break;case"MOBILE":var i="<div class='alert alert-warning' style='text-align: center;' role='alert'>";i+="You already uploaded the allowed number of mobile photos.";i+="</div>";e("#wppc-results").html(i).show();break;case"FILEFAIL":var i="<div class='alert alert-warning' style='text-align: center;' role='alert'>";i+="You already uploaded the allowed number of mobile photos.";i+="</div>";e("#wppc-results").html(i).show();break;default:e("#wppc-results").hide();s(t);break}e("#wppc-submit").removeClass("disabled");e("#wppc-loading").hide()},error:function(e,t,n){console.log(e)}})})})